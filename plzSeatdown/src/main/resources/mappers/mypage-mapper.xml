<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mypageMapper">

      <resultMap type="Member" id="memberResultSet">
       <id property="memberNo" column="MEMBER_NO"/>
       <result property="memberId" column="MEMBER_ID"/>
       <result property="memberPwd" column="MEMBER_PWD"/>
       <result property="memberName" column="MEMBER_NM"/>
       <result property="memberNickname" column="MEMBER_NICKNM"/>
       <result property="memberEmail" column="MEMBER_EMAIL"/>
       <result property="memberEmailCheck" column="MEMBER_EMAIL_CHECK"/>
       <result property="memberPhone" column="MEMBER_PHONE"/>
       <result property="memberEnrollDate" column="MEMBER_ENROLL_DT"/>
       <result property="memberReportCount" column="MEMBER_REPORT_CNT"/>
       <result property="memberStatus" column="MEMBER_STATUS"/>
       <result property="memberGrade" column="MEMBER_GRADE"/>
    </resultMap>
    
     <resultMap type="Profile" id="profileResultSet">
       <id property="profileNo" column="PROFILE_NO"/>
       <result property="profilePath" column="PROFILE_PATH"/>
       <result property="uploadDate" column="UPLOAD_DT"/>
       <result property="profileStatus" column="PROFILE_STATUS"/>
       <result property="memberNo" column="MEMBER_NO"/>
    </resultMap>
    
    
      <resultMap type="QnAEH" id="QnAEHResultSet">
       <id property="qnaNo" column="QNA_NO"/>
       <result property="qnaContent" column="QNA_CONTENT"/>
       <result property="qnaCreateDate" column="QNA_CREATE_DT"/>
       <result property="qnaStatus" column="QNA_STATUS"/>
       <result property="qnaWriter" column="QNA_WRITER"/>
       <result property="qnaAnswer" column="QNA_ANSWER"/>
    </resultMap>
    
          <resultMap type="QnA" id="QnAResultSet">
       <id property="qnaNo" column="QNA_NO"/>
       <result property="qnaContent" column="QNA_CONTENT"/>
       <result property="qnaCreateDate" column="QNA_CREATE_DT"/>
       <result property="qnaStatus" column="QNA_STATUS"/>
       <result property="qnaWriter" column="QNA_WRITER"/>
    </resultMap>
    
    
    
    
    <!-- 마이페이지 조회용 -->
    <select id="selectMypage" parameterType="_int" resultMap="memberResultSet">
      SELECT*FROM MEMBER
      WHERE MEMBER_NO=#{memberNo}
   </select>
   
   
   <!-- 마이페이지 프로필 조회용 -->
   <select id="selectMypageProf" parameterType="_int" resultMap="profileResultSet">
      SELECT * FROM PROFILE 
      WHERE MEMBER_NO = #{memberNo}
      AND PROFILE_STATUS='Y'
   </select>

 
      <!-- 비밀번호 조회 -->
   <select id="selectPwd" parameterType="_int" resultType="string">
      SELECT MEMBER_PWD
      FROM MEMBER
      WHERE MEMBER_NO=#{memberNo}
   </select>
   
      <!-- 비밀번호 수정용 -->
   <update id="updatePwd" parameterType="Member">
      UPDATE MEMBER
      SET MEMBER_PWD=#{memberPwd}
      WHERE MEMBER_NO=#{memberNo}
   </update>

      <!-- 회원탈퇴용 -->
   <update id="deleteMember" parameterType="Member">
      UPDATE MEMBER
      SET MEMBER_STATUS='N' 
      WHERE MEMBER_NO=#{memberNo}
   </update>
   
   
   <!-- 마이페이지 수정용 -->
	<update id="updateMypage" parameterType="Member">
		UPDATE MEMBER
		SET MEMBER_ID = #{memberId}, MEMBER_NM = #{memberName}, 
		    MEMBER_NICKNM = #{memberNickname}, MEMBER_EMAIL = #{memberEmail}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	<!-- 마이페이지 프로필 삽입용  -->
	<insert id="insertProfile" parameterType="Profile">
		INSERT INTO PROFILE VALUES
		(SEQ_P_INO.NEXTVAL, #{profilePath}, DEFAULT, DEFAULT, #{memberNo})
	</insert>
	
	<!-- 마이페이지 프로필 수정용 -->
	<update id="updateProfile" parameterType="Profile">
		UPDATE PROFILE 
		SET PROFILE_PATH = #{profilePath},
			UPLOAD_DT = SYSDATE
		WHERE PROFILE_NO = #{profileNo}
	</update>

   
   
   <!-- QNA(ASK) -->
   
   <!-- QNA 게시글수 조회용  -->
   <select id="getAskCount" resultType="_int"> 
   	 SELECT COUNT(*) FROM QNA
     WHERE QNA_STATUS='Y' OR QNA_STATUS='N'
   </select>
   
   
   <!-- QNA 목록 조회 -->
   <select id="selectQlist" resultMap="QnAResultSet">
      SELECT QNA_NO, QNA_CONTENT, QNA_CREATE_DT, QNA_STATUS
      FROM QNA 
      WHERE QNA_STATUS='Y'OR QNA_STATUS='N'
   </select>
   
   <!-- QNA 상세조회용  -->
   <select id="selectAsk" parameterType="_int" resultMap="QnAEHResultSet">
      SELECT * FROM V_QNAEH
      WHERE QNA_NO = #{no}
   </select>


</mapper>